 # Домашнее задание к занятию "4.8. Траблшутинг"

---

### Задание 1. 

1. Укажите путь к файлам логов веб-сервера `Nginx`. 
2. Где находится конфигурационный файл, в котором можно посмотреть / поменять эти пути?
3. Какой командой можно воспользоваться для просмотра файла журнала в режиме реального времени?
Попробуйте найти сами, либо воспользуйтесь [ссылкой](https://andreyex.ru/operacionnaya-sistema-linux/nastrojka-zhurnala-oshibok-i-dostupa-nginx/).

*Приведите ответ в свободной форме.

--- 

**Выполнение задания: Задание 1.**

* 1) Путь к файлам логов веб-сервера Nginx:

`/var/log/nginx/access.log` - журнал доступа

и 

`/var/log/nginx/error.log`  - журнал ошибок

* 2) Пути логов и конфигурация сервера задаются в файле 

`/etc/nginx/nginx.conf`

* 3) Для мониторинга в реальном времени можно выводить информацию в реальном времени командой: 

`sudo tail -f  /var/log/nginx/access.log`

![img2.jpg](https://github.com/elekpow/netology/blob/main/net-net_protocol/images/img2.jpg)

* в выводе представлена информация о доступе к странице  **page1.html** и времени доступа **22/Jan/2023:22:24:29** а также различная информация о  веб браузере, операционной системе, протоколе , коде странице и т.д.

```
192.168.56.1 - - [22/Jan/2023:22:24:29 +0300] "GET /page1.html HTTP/1.1" 304 0 "http://192.168.56.104:81/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 YaBrowser/22.11.5.715 Yowser/2.5 Safari/537.36"
```
* Также для мониторинга в реальном времени существует - **Ngxtop,**  устанавливается он через **pip**  — систему управления пакетами используемая  для установки и управления программными пакетами, написанными на Python. `pip install ngxtop`

**Пример: Веб Сервер nginx запущен на 81 порту, создана тестовая страница page1.html**


![img3.jpg](https://github.com/elekpow/netology/blob/main/net-net_protocol/images/img3.jpg)


---

### Задание 2. 

Познакомьтесь со схемой сети.

![](https://i.imgur.com/RefFHYj.png)

1. `COMP1` не может обменяться данными с `COMP4`. Какую последовательность действий вы выберете для того, чтобы локализовать проблему?
2. Возможно ли, чтобы при выполнении `ping 192.168.1.2` с компьютера `COMP5`, `ping` прошёл, а подключение по HTTP с `COMP5` на `COMP1` не проходило бы? Поясните свой  ответ максимально детально.
3. `COMP5` отправляет `ping` на `COMP1` и `COMP2`, при этом `COMP1` на `ping` отвечает, а `COMP2` - нет. 

Приведите максимальное количество причин. Самую простую, но нередко встречающуюся - «У `COMP2` выдернули кабель питания» - я уже ответил за вас.

4. `COMP1` пингует только адреса из подсети `192.168.1.0/24` (`COMP2` и `192.168.1.1`), больше никакие адреса не пингуются. С чем это может быть связано? 

*Приведите ответ в свободной форме.

--- 

**Выполнение задания: Задание 2.**


![img4.jpg](https://github.com/elekpow/netology/blob/main/net-net_protocol/images/img4.jpg)


* 1) COMP1 не может обменяться данными с COMP4. 

- Если все устройства включены и сеть работает.

Для начала на проверить настройки COMP1 , выполнить ipconfig, или ip a,  зная сеть, проверяем доступен ли маршрутизатор, 

выполним: `ping 192.168.1.1` 

также проверим доступен ли внеший ip маршрутизатора `ping 10.1.1.1` и теперь проверим доступен ли второй маршрутизатор.

можно выполнить трассировку маршрута до удаленного компьютера `tracert 192.168.2.3`, 

по трассировке мы увидим ip адреса всех промежуточных устройств. 

*Из причин также может быть неисправность и маршрутизаторов как физически так и аппаратно, например заблокирован порт.

    • По данной схеме COMP4 (ip 192.168.2.3) также как и COMP3  (ip 192.168.2.3) явно возник конфликт ip адресов.


* 2) Возможно ли, чтобы при выполнении ping 192.168.1.2 с компьютера COMP5, ping прошёл, а подключение по HTTP с COMP5 на COMP1 не проходило бы? 
    • Да. Подключение к 80 порту будет доступно если будет настроена статичная nat трансляция. На COMP1 должен быть открыт порт 80, запущена служба, которая работает на этом порту.

* 3) COMP5 отправляет ping на COMP1 и COMP2, при этом COMP1 на ping отвечает, а COMP2 - нет. Приведите максимальное количество причин. 
    • команда ping введена с ошибкой (ping192,168,1,3)
    • неисправность на коммутаторе 
    • неисправные порты подключения
    • перебит кабель
    • неисправная сетевая карта
    • отключена сетевая карта 
    • настроен другой VLAN
    • ip COMP2 не тот что мы пингуем, например из за неисправности сетевой карты настройки изменились.
    • Антивирусная программа блокирует сеть
    • отключены эхо-запросы ICMP на COMP2

* 4) COMP1 пингует только адреса из подсети 192.168.1.0/24 (COMP2 и 192.168.1.1), больше никакие адреса не пингуются. С чем это может быть связано?
    • внешняя сеть не доступна
    • отсутствует маршрут до другой сети
    • неверно настроен маршрутизатор


---


### Задание 3. 

Используя схему из Задания 2, попробуйте ответить на вопросы:
1. `COMP1` и `COMP2` оба пингуют `10.1.1.2`, однако не пингуют `192.168.2.1` и прочие адреса из `192.168.2.0/24`. Как вы думаете, что не так и как это можно исправить?
2. Какими способами мы можем сделать так, чтобы `COMP2` не смог общаться ни с кем кроме своей локальной сети? (Приведите вариант с настройками самого `COMP2` и попробуйте придумать, можно ли что-то сделать на маршрутизаторе `192.168.1.1`)
3. Как вы думаете, что будет происходить при попытке провести `ping` с `COMP5` на `192.168.2.3` ?

*Приведите ответ в свободной форме.

--- 

**Выполнение задания: Задание 3.**


    1) **COMP1 и COMP2** оба пингуют `10.1.1.2`, однако не пингуют `192.168.2.1` и прочие адреса из `192.168.2.0/24`. Как вы думаете, что не так и как это можно исправить?
    
* Не настроена маршрутизация на роутере, можно прописать маршрут  `0.0.0.0 0.0.0.0 10.1.1.2` , на втором `0.0.0.0 0.0.0.0 10.1.1.1`


    2) Какими способами мы можем сделать так, чтобы **COMP2** не смог общаться ни с кем кроме своей локальной сети? (Приведите вариант с настройками самого **COMP2** и попробуйте придумать, можно ли что-то сделать на маршрутизаторе `192.168.1.1`
   
* ipconfig 

```
-IPv4 Address....................: 192.168.1.3
-Subnet Mask.....................: 255.255.255.0
-Default Gateway................: 192.168.1.1
```
    • отключить маршрутизацию между сетями. 
    • создать ограничения через списки ACL
    • создать для устройств сети `192.168.1.0` отдельный vlan (private VLAN)


    3) Как вы думаете, что будет происходить при попытке провести ping с COMP5 на `192.168.2.3` ?

* Устройства находятся в одной локальной сети. При отправке ping COMP5 будет отправлять на запросы на хост `192.168.2.3 `с мак адресом имеющимся у него в таблице ARP-кэша. 
* При отправке хосту необходимо отправить ARP запрос (широковещательный), его получат все устройства. **COMP5** получит MAC адрес от первого ответившего хоста и обновит свою таблицу ARP-кэша. 
* После включения второго хоста с `192.168.2.3` в сеть, обмен данными с ним происходить не будет.



