# Домашнее задание к занятию <br/> «Уязвимости и атаки на информационные системы»  <br/> Игорь Левин

------

### Задание 1

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя **nmap**.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

Ответьте на следующие вопросы:

- Какие сетевые службы в ней разрешены?
- Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)
  
*Приведите ответ в свободной форме.*  


---

**Выполнение задания 1.**


Узнаем информацию о машине и запущенных на ней сервисах через  **nmap** с ключем -sV

Утилита подключится к каждому порту и определит всю доступную информацию:

`sudo nmap -sV 192.168.56.114`

![nmap1.JPG](https://github.com/elekpow/netology/blob/main/inform/lesson1/images/nmap1.JPG)


На сайте https://vulners.com/ (База данных уязвимостей и поисковая система) есть скрипт NSE  - **nmap_vulners**  для **nmap**.
Скрипт NSE использует информацию об известных сервисах для предоставления данных об уязвимостях. 

[скрипт nmap_vulners](https://vulners.com/plugins#offensive)

Установка:
```
sudo cp ~/Downloads/vulners.nse /usr/share/nmap/scripts/
sudo nmap --script-updatedb
```
Запуск:
```
sudo nmap -sV --script vulners 192.168.56.114
```

Воспользуемся дистрибутивом Kalilinux который уже содержит скрипт. 

---


1) 
порт 53/TCP (ISC BIND 9.4.2)

[CVE-2014-8500](https://vulners.com/search?query=CVE-2014-8500)


описание уязвимости (перевод):

>> ISC BIND с 9.0.x по 9.8.x, с 9.9.0 по 9.9.6 и с 9.10.0 по 9.10.1 не ограничивает цепочку делегирования, что позволяет удаленным злоумышленникам вызывать отказ в обслуживании (потребление памяти и именованный сбой) с помощью большого или бесконечного числа обращений.

2) 
порт 22/TCP (OpenSSH 4.7p1)

[CVE-2010-4478](https://vulners.com/search?query=CVE-2010-4478) 

описание уязвимости (перевод):

>> OpenSSH 5.6 и более ранних версий, когда включен J-PAKE, неправильно проверяет общедоступные параметры в протоколе J-PAKE, что позволяет удаленным злоумышленникам обходить необходимость в знании общего секрета и успешно проходить аутентификацию, отправляя обработанные значения в каждом раунде протокола, что связано с проблемой, связанной с CVE-2010-4252.

3)
порт 80/TCP (Apache http_server 2.2.8)

[CVE-2017-7679](https://vulners.com/cve/CVE-2017-7679)

описание уязвимости (перевод):

>> В Apache httpd 2.2.x до версии 2.2.33 и 2.4.x до версии 2.4.26 mod_mime может считывать один байт после конца буфера при отправке заголовка ответа вредоносного типа содержимого.



**После отработки скрипта , nmap выведет все найденные уязвимости.**

пример вывода:

![vulners.JPG](https://github.com/elekpow/netology/blob/main/inform/lesson1/images/vulners.JPG)




### Задание 2

Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.

Запишите сеансы сканирования в Wireshark.

Ответьте на следующие вопросы:

- Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?
- Как отвечает сервер?

*Приведите ответ в свободной форме.*

---

**Выполнение задания 2.**

*Wireshark - сетевой анализатор, для анализа трафика проходящего через сетевой интерфейс.*

Установка: `sudo apt install wireshark`. Воспользуемся уже установленным в **Kalilinux**. Проведём сканирование сети и запишем сессию.

<img src="https://github.com/elekpow/netology/blob/main/inform/lesson1/images/wireshark.JPG" alt="wireshark.JPG" width="500">

- По умолчанию Nmap осуществляет SYN сканирование. `nmap -sS` (TCP SYN сканирование), этот тип использует только пакеты SYN для определения того, открыт ли порт. 
Этот тип сканирования заменяет сканирование с использованием соединения для пользователей не имеющих достаточных привилегий.

Отсылается SYN пакет. При получении ответы SYN/ACK указывают на то, что порт прослушивается (открыт). RST (сброс) указывает на то, что порт не прослушивается.


```
sudo nmap -sS 192.168.56.114 
```

 Запись Wireshark: [Metasploitable.pcapng](https://github.com/elekpow/netology/blob/main/inform/lesson1/files/Metasploitable.pcapng)



- Для режима FIN  используется флаг `-sF` в этом режиме Nmap отправляет TCP FIN пакеты на целевые порты, если порт закрыт, устройство отправляет обратно RST пакет, а если порт открыт, то никакого ответа не будет получено. FIN-сканирование используется для определения открытых портов без вызова создания логов на атакуемом устройстве.

Из документации на работу в режиме сканирования FIN следует:  любой пакет, не содержащий установленного бита SYN, RST или ACK, повлечет за собой отправку RST в ответ в случае, если порт закрыт, или не повлечет никакого ответа, если порт открыт.  Т.к. ни один из этих битов не установлен, то любая комбинация трех оставшихся (FIN, PSH и URG) будет являться правильной.


```
sudo nmap -sF 192.168.56.114 
```

Запись Wireshark: [Metasploitable_sf.pcapng](https://github.com/elekpow/netology/blob/main/inform/lesson1/files/Metasploitable_sf.pcapng)

<img src="https://github.com/elekpow/netology/blob/main/inform/lesson1/images/wireshark_sf.JPG" alt="wireshark_sf.JPG" width="500">

- Для режима Xmas  используется флаг `-sX` . В Xmas-сканировании Nmap отправляет пакеты, устанавливающие состояние URG, PUSH и FIN для определенных портов. Если порт закрыт, устройство отправляет RST пакет в ответ, а если порт открыт, то никакого ответа не будет получено. 

```
sudo nmap -sX 192.168.56.114 
```

Запись Wireshark: [Metasploitable_sx.pcapng](https://github.com/elekpow/netology/blob/main/inform/lesson1/files/Metasploitable_sx.pcapng)


<img src="https://github.com/elekpow/netology/blob/main/inform/lesson1/images/wireshark_sx.JPG" alt="wireshark_sx.JPG" width="500">


- Для режима UDP  используется флаг `-sU`, он используется для сканирования UDP-портов на устройствах.
 Nmap будет отправлять UDP-пакеты на указанные порты и анализировать полученные ответы. Открытый порт считается доступным, закрытый - недоступным, а если ответ не получен, порт считается фильтрованным (filtered).
 
```
sudo nmap -sU 192.168.56.114 
``` 
 
При сканировании **Metasploitable** обнаружено:
```
PORT     STATE         SERVICE
53/udp   open          domain
68/udp   open|filtered dhcpc
69/udp   open|filtered tftp
111/udp  open          rpcbind
137/udp  open          netbios-ns
138/udp  open|filtered netbios-dgm
2049/udp open          nfs
```



Запись Wireshark: [Metasploitable_su.pcapng](https://github.com/elekpow/netology/blob/main/inform/lesson1/files/Metasploitable_su.pcapng)


Из документации на режим работы в UDP следует: UDP сканирование работает путем посылки пустого (без данных) UDP заголовка на каждый целевой порт. Если в ответ приходит ICMP ошибка о недостижимости порта (тип 3, код 3), значит порт закрыт. Другие ICMP ошибки недостижимости (тип 3, коды 1, 2, 9, 10 или 13) указывают на то, что порт фильтруется. Иногда, служба будет отвечать UDP пакетом, указывая на то, что порт открыт. Если после нескольких попыток не было получено никакого ответа, то порт классифицируется как `открыт|фильтруется`. Это означает, что порт может быть открыт, или, возможно, пакетный фильтр блокирует его.





<img src="https://github.com/elekpow/netology/blob/main/inform/lesson1/images/wireshark_su.JPG" alt="wireshark_su.JPG" width="500">


